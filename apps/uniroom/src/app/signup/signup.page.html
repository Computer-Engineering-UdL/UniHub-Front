<ion-content [fullscreen]="true">
  <div class="auth-container">
    <!-- Language Selector -->
    <div class="language-selector">
      <ion-button fill="clear" size="small" (click)="changeLanguage('en')"> EN </ion-button>
      <ion-button fill="clear" size="small" (click)="changeLanguage('es')"> ES </ion-button>
      <ion-button fill="clear" size="small" (click)="changeLanguage('ca')"> CA </ion-button>
    </div>

    <!-- Logo/Header Section -->
    <div class="auth-header">
      <ion-icon name="person-add-outline" class="logo-icon"></ion-icon>
      <h1>{{ 'SIGNUP.TITLE' | translate }}</h1>
      <p class="subtitle">{{ 'SIGNUP.SUBTITLE' | translate }}</p>
    </div>

    <!-- Signup Form -->
    <ion-card class="auth-card">
      <ion-card-content>
        <form (ngSubmit)="signup()" #signupForm="ngForm" autocomplete="on">
          <ion-item
            lines="none"
            class="input-item"
            [class.input-error]="firstNameTouched && !firstName">
            <ion-icon name="person-outline" slot="start"></ion-icon>
            <ion-input
              type="text"
              [placeholder]="'SIGNUP.FIRST_NAME' | translate"
              [(ngModel)]="firstName"
              name="firstName"
              [required]="true"
              (ionBlur)="firstNameTouched = true"
              (ionInput)="onFirstNameInput()"></ion-input>
          </ion-item>
          <div *ngIf="firstNameTouched && !firstName" class="input-error-message">
            {{ 'SIGNUP.ERROR.EMPTY_FIELDS' | translate }}
          </div>

          <ion-item
            lines="none"
            class="input-item"
            [class.input-error]="lastNameTouched && !lastName">
            <ion-icon name="person-outline" slot="start"></ion-icon>
            <ion-input
              type="text"
              [placeholder]="'SIGNUP.LAST_NAME' | translate"
              [(ngModel)]="lastName"
              name="lastName"
              [required]="true"
              (ionBlur)="lastNameTouched = true"
              (ionInput)="onLastNameInput()"></ion-input>
          </ion-item>
          <div *ngIf="lastNameTouched && !lastName" class="input-error-message">
            {{ 'SIGNUP.ERROR.EMPTY_FIELDS' | translate }}
          </div>

          <ion-item
            lines="none"
            class="input-item"
            [class.input-error]="emailTouched && !validateEmail(email)">
            <ion-icon name="mail-outline" slot="start"></ion-icon>
            <ion-input
              type="email"
              [placeholder]="'SIGNUP.EMAIL' | translate"
              [(ngModel)]="email"
              name="email"
              [required]="true"
              (ionBlur)="emailTouched = true"
              (ionInput)="onEmailInput()"></ion-input>
          </ion-item>
          <div *ngIf="emailTouched && !validateEmail(email)" class="input-error-message">
            {{ 'SIGNUP.ERROR.INVALID_EMAIL' | translate }}
          </div>

          <ion-item
            lines="none"
            class="input-item"
            [class.input-error]="phoneTouched && !validatePhone(phone)">
            <ion-icon name="call-outline" slot="start"></ion-icon>
            <ion-input
              type="tel"
              inputmode="tel"
              pattern="^[+]?\\d{0,15}$"
              [maxlength]="16"
              [placeholder]="'SIGNUP.PHONE' | translate"
              [(ngModel)]="phone"
              name="phone"
              (ionInput)="onPhoneInput($event); onPhoneInputTouched()"
              (ionBlur)="phoneTouched = true"></ion-input>
          </ion-item>
          <div *ngIf="phoneTouched && !validatePhone(phone) && phone" class="input-error-message">
            {{ 'SIGNUP.ERROR.INVALID_PHONE' | translate }}
          </div>

          <ion-item lines="none" class="input-item">
            <ion-icon name="school-outline" slot="start"></ion-icon>
            <ion-input
              type="text"
              [placeholder]="'SIGNUP.UNIVERSITY' | translate"
              [(ngModel)]="university"
              name="university"></ion-input>
          </ion-item>

          <ion-item
            lines="none"
            class="input-item"
            [class.input-error]="passwordTouched && password.length < 8">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            <ion-input
              type="password"
              [placeholder]="'SIGNUP.PASSWORD' | translate"
              [(ngModel)]="password"
              name="password"
              [required]="true"
              (ionBlur)="passwordTouched = true"
              (ionInput)="onPasswordInput()"></ion-input>
          </ion-item>
          <div *ngIf="passwordTouched && password.length < 8" class="input-error-message">
            {{ 'SIGNUP.ERROR.PASSWORD_TOO_SHORT' | translate }}
          </div>

          <ion-item
            lines="none"
            class="input-item"
            [class.input-error]="confirmPasswordTouched && password !== confirmPassword">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            <ion-input
              type="password"
              [placeholder]="'SIGNUP.CONFIRM_PASSWORD' | translate"
              [(ngModel)]="confirmPassword"
              name="confirmPassword"
              [required]="true"
              (ionBlur)="confirmPasswordTouched = true"
              (ionInput)="onConfirmPasswordInput()"></ion-input>
          </ion-item>
          <div
            *ngIf="confirmPasswordTouched && password !== confirmPassword"
            class="input-error-message">
            {{ 'SIGNUP.ERROR.PASSWORD_MISMATCH' | translate }}
          </div>

          <ion-button
            expand="block"
            type="submit"
            class="auth-button"
            [disabled]="isLoading || !firstName || !lastName || !validateEmail(email) || password.length < 8 || password !== confirmPassword || (!!phone && !validatePhone(phone))">
            <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
            <span *ngIf="!isLoading">{{ 'SIGNUP.SIGN_UP' | translate }}</span>
          </ion-button>
        </form>

        <!-- Divider -->
        <div class="divider">
          <span>{{ 'SIGNUP.OR_CONTINUE_WITH' | translate }}</span>
        </div>

        <!-- Social Signup Buttons -->
        <div class="social-buttons">
          <ion-button
            expand="block"
            fill="outline"
            class="social-button github-button"
            (click)="signupWithGithub()"
            [disabled]="isLoading">
            <ion-icon name="logo-github" slot="start"></ion-icon>
            {{ 'COMMON.GITHUB' | translate }}
          </ion-button>

          <ion-button
            expand="block"
            fill="outline"
            class="social-button google-button"
            (click)="signupWithGoogle()"
            [disabled]="isLoading">
            <ion-icon name="logo-google" slot="start"></ion-icon>
            {{ 'COMMON.GOOGLE' | translate }}
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Sign In Link -->
    <div class="auth-link">
      <p>
        {{ 'SIGNUP.HAVE_ACCOUNT' | translate }}
        <a routerLink="/login">{{ 'SIGNUP.SIGN_IN' | translate }}</a>
      </p>
    </div>
  </div>
</ion-content>
